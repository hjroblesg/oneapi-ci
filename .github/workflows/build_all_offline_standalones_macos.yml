# SPDX-FileCopyrightText: 2020 Intel Corporation
#
# SPDX-License-Identifier: MIT

name: build_macos_offline_standalones

on:
  push: {}
  workflow_dispatch: {}
  schedule:
    - cron: '0 0 * * *'

env:
  MACOS_ISPC_URL: https://registrationcenter-download.intel.com/akdlm/IRC_NAS/04fba3d6-15ed-4c71-938b-d29d0811461a/m_ispc_p_2024.1.0.727_offline.dmg
  MACOS_EMBREE_URL: https://registrationcenter-download.intel.com/akdlm/IRC_NAS/cae476a0-3975-4752-b4ef-222bf746b0ef/m_embree_p_2024.1.0.712_offline.dmg
  MACOS_OIDN_URL: https://registrationcenter-download.intel.com/akdlm/IRC_NAS/d3ae4881-54ac-436b-a01b-20e9502be9b8/m_oidn_p_2024.1.0.697_offline.dmg
  MACOS_OPGL_URL: https://registrationcenter-download.intel.com/akdlm/IRC_NAS/d0986691-f49a-4768-936c-b0baffa98a53/m_openpgl_p_2024.1.0.728_offline.dmg
  MACOS_OVKL_URL: https://registrationcenter-download.intel.com/akdlm/IRC_NAS/2a8b0a62-1dce-418b-965f-30255b49d604/m_openvkl_p_2024.1.0.731_offline.dmg
  MACOS_OSPRAY_URL: https://registrationcenter-download.intel.com/akdlm/IRC_NAS/fe0bc466-3de5-4448-a0b1-7d2677e26ba9/m_ospray_p_2024.1.0.737_offline.dmg
  MACOS_OSPRAYSTD_URL: https://registrationcenter-download.intel.com/akdlm/IRC_NAS/f71b24b6-dcd1-4217-94fc-a00ad7f55b22/m_ospray_studio_p_2024.1.0.708_offline.dmg
  SAMPLES_TAG: 2024.1.0

jobs:
  build_macos_ispc:
    runs-on: macos-latest
    timeout-minutes: 40
    defaults:
      run:
        shell: bash
    steps:
    - uses: actions/checkout@v2
    - name: install_ispc
      run: scripts/install_macos.sh $MACOS_ISPC_URL
    - name: Saving install logs
      if: ${{ always() }}
      uses: actions/upload-artifact@v2
      with:
        name: InstallLogs_${{ github.job }}
        path: |
          bootstrapper*
          installer*
        retention-days: 7

  build_macos_embree:
    runs-on: macos-latest
    timeout-minutes: 40
    defaults:
      run:
        shell: bash
    steps:
    - uses: actions/checkout@v2
    - name: install_embree
      run: scripts/install_macos.sh $MACOS_EMBREE_URL
    - name: Saving install logs
      if: ${{ always() }}
      uses: actions/upload-artifact@v2
      with:
        name: InstallLogs_${{ github.job }}
        path: |
          bootstrapper*
          installer*
        retention-days: 7

  build_macos_oidn:
    runs-on: macos-latest
    timeout-minutes: 40
    defaults:
      run:
        shell: bash
    steps:
    - uses: actions/checkout@v2
    - name: install_oidn
      run: scripts/install_macos.sh $MACOS_OIDN_URL
    - name: Saving install logs
      if: ${{ always() }}
      uses: actions/upload-artifact@v2
      with:
        name: InstallLogs_${{ github.job }}
        path: |
          bootstrapper*
          installer*
        retention-days: 7

  build_macos_openpgl:
    runs-on: macos-latest
    timeout-minutes: 40
    defaults:
      run:
        shell: bash
    steps:
    - uses: actions/checkout@v2
    - name: install_openpgl
      run: scripts/install_macos.sh $MACOS_OPGL_URL
    - name: Saving install logs
      if: ${{ always() }}
      uses: actions/upload-artifact@v2
      with:
        name: InstallLogs_${{ github.job }}
        path: |
          bootstrapper*
          installer*
        retention-days: 7

  build_macos_openvkl:
    runs-on: macos-latest
    timeout-minutes: 40
    defaults:
      run:
        shell: bash
    steps:
    - uses: actions/checkout@v2
    - name: install_openvkl
      run: scripts/install_macos.sh $MACOS_OVKL_URL
    - name: Saving install logs
      if: ${{ always() }}
      uses: actions/upload-artifact@v2
      with:
        name: InstallLogs_${{ github.job }}
        path: |
          bootstrapper*
          installer*
        retention-days: 7

  build_macos_ospray:
    runs-on: macos-latest
    timeout-minutes: 40
    defaults:
      run:
        shell: bash
    steps:
    - uses: actions/checkout@v2
    - name: install_ospray
      run: scripts/install_macos.sh $MACOS_OSPRAY_URL
    - name: Saving install logs
      if: ${{ always() }}
      uses: actions/upload-artifact@v2
      with:
        name: InstallLogs_${{ github.job }}
        path: |
          bootstrapper*
          installer*
        retention-days: 7

  build_macos_ospraystd:
    runs-on: macos-latest
    timeout-minutes: 40
    defaults:
      run:
        shell: bash
    steps:
    - uses: actions/checkout@v2
    - name: install_ospraystd
      run: scripts/install_macos.sh $MACOS_OSPRAYSTD_URL
    - name: Saving install logs
      if: ${{ always() }}
      uses: actions/upload-artifact@v2
      with:
        name: InstallLogs_${{ github.job }}
        path: |
          bootstrapper*
          installer*
        retention-days: 7
